name: "Setup Python with pyenv-win"
description: "Setup Python on Windows through pyenv-win"

inputs:
  arch:
    description: "Hardware architecture"
    required: true
    default: "x64"
  python-version:
    description: "Python version"
    required: true
    default: "latest"
  pyenv-folder:
    description: "pyenv-win installation folder"
    required: true
    default: "C:\\ProgramData\\pyenv-win"
  pyenv-version:
    description: "pyenv-win branch or tag"
    required: true
    default: "master"

runs:
  using: "composite"
  steps:
    -
      name: Set pyenv-win
      shell: pwsh
      run: |
        Set-Variable -Name "PYENV" -Value "${{ inputs.pyenv-folder }}\pyenv-win"
        git clone --depth 1 -b ${{ inputs.pyenv-version }} `
            https://github.com/pyenv-win/pyenv-win.git ${{ inputs.pyenv-folder }}
        echo PYENV="${PYENV}\" >> $env:GITHUB_ENV
        echo PYENV_HOME="${PYENV}\" >> $env:GITHUB_ENV
        echo PYENV_ROOT="${PYENV}\" >> $env:GITHUB_ENV
        echo PATH="${PYENV}\bin;${PYENV}\shims;$env:PATH" >> $env:GITHUB_ENV
